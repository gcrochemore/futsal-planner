<h1><%= t('.title') %><span class="badge"><%= @users.count %></span></h1>

<div class="row">
  <div class="col-2">
    <legend class="filter-title"><%= t :search_title %></legend>
    <fieldset class="filter-panel">
      <%= search_form_for @q do |f| %>

        <%= f.search_field :first_name_cont, {placeholder: t('activerecord.attributes.user.first_name')} %>

        <%= f.search_field :last_name_cont, {placeholder: t('activerecord.attributes.user.last_name')} %>

        <%= f.search_field :company_name_cont, {placeholder: t('activerecord.attributes.user.company')} %>

        <%= f.search_field :goal_cont, {placeholder: t('activerecord.attributes.user.goal')} %>

        <%= f.search_field :assist_cont, {placeholder: t('activerecord.attributes.user.assist')} %>

        <br>
        <br>
        <%= f.submit class: 'btn btn-search-filter btn-sm btn-outline-primary' %>
      <% end %>
    </fieldset>
  </div>
  <div class="col">
    <div class="col-md-3 btn-new-top">
      <% if can? :create, User %>
        <%= link_to (icon('plus') + " " + t('.new_button')).html_safe, url_for(action: :new), class: "btn btn-sm btn-outline-primary" %>
      <% end %>
    </div>
    <table class="table table-hover table-sm table-bordered">
      <thead>
        <tr>
          <th></th>
    
          <th><%= sort_link(@q, :first_name, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :last_name, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :company_name, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :goal, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :goal_average_by_match, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :assist, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :assist_average_by_match, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :match, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :rating, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :futsal_position, default_order: :asc) %></th>
    
          <th><%= sort_link(@q, :goalkeeper_goal_against_average, default_order: :asc) %></th>
    
          <th class="col-xs-1"></th>
        </tr>
      </thead>

      <tbody>
        <% @users.each do |user| %>
          <tr>
            <td><img src="/assets/fifa/players/<%= user.andand.picture ? user.andand.picture : 'inconnu.jpg' %>"></td>
    
            <td><%= user.first_name %></td>
    
            <td><%= user.last_name %></td>
    
            <td><%= user.company %></td>
    
            <td><%= user.goal %></td>

            <td><%= user.goal_average_by_match.to_f.round(2) %></td>            
    
            <td><%= user.assist %></td>

            <td><%= user.assist_average_by_match.to_f.round(2) %></td>        
    
            <td><%= user.match %> (avec stats : <%= user.match_with_stats %>)</td>

            <td><%= user.rating.to_f.round(2) %></td>

            <td><%= user.futsal_position %></td>

            <td><%= (user.goalkeeper_goal_against_average || 0).round(2) %></td>
    
            <td>
              <%= link_to icon('eye').html_safe, user %>
              <% if can? :edit, User %>
                <%= link_to icon('pencil').html_safe, edit_user_path(user) %>
              <% end %>
              <% if can? :destroy, User %>
                <%= link_to icon('times').html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <%= will_paginate @users %>
  </div>
</div>